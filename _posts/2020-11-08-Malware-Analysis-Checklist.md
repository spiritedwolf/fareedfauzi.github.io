---
title: "Malware Analysis Checklist"
date: "2020-11-08"
layout: single
tags:
- Malware
categories:
- Notes
---

When doing an analysis or investigation on a malware, what is the important things to solve or to answer in analysing the malware? 

This checklist may help us to determine what is the goal when we're doing a malware analysis on a malware, so it can avoid us from reversing/analysing part of the malicious code that does not important to our investigation or maybe a rabbit hole.

0. Initial access?
1. How it downloads, starts or executes?
    - Where it come from
    - How it has to be there
    - Which parent program that drop it?
    - How it executes? User run it? Someone remotely run it?
2. Is there any anti techniques implemented?
    - Anti Debugging
    - Anti Disassembly
    - Anti VM
    - Antivirus/EDR evasion
    - Packer
    - Cryptor
    - Sandbox evasion
3. Is there any basic, automated, dynamic analysis result that can give us any hints?
    - Basic analysis
        - strings
        - MultiAV result
        - ssdeep (comparing with other variant)
        - PE analysis
    - Dynamic analysis
        - Process
        - File system
        - Network
        - Registry        
    - Sandbox analysis result
        - Static analysis result
        - Dynamic analysis result
4. What are the things we looking for?
    - IOCs
    - Commands
    - Dropped files
    - Domains / IP
    - Registry modify/add/delete
    - Techniques, Tactics and procedures
    - Encryption/Decryption routines
    - Folder, file access
    - Malware features
    - Hardcoded values / strings
    - Common WinAPI used for malicious action
    - Shellcode
    - Encrypted things
5. What are some of the malware features?
    - Downloader
    - Launcher
    - Backdoor
        - Reverse Shell
        - RAT
        - Botnet
    - Credential stealer
        - Keylogger
        - Mimikatz thingy
    - Encrypt file
    - Command and control
    - Propagation
    - Exploit
    - Process Manipulating
        - Process injection etc.
    - Bypass UAC
    - Evade AV
    - Anti Forensic
6. What is the behavior meaning of the findings?
    - Is the domain really does the command and control?
    - Why is it encrypt a certain part?
7. Does it have persistant mechanism?
    - Registry key
    - Scheduled tasks
    - Startup folder
    - Winlogon Registry Entries
    - Image file execution options
    - Accessibility programs
    - WMIC Persitent
    - AppInit_DLLs
    - DLL Search Order Hijacking
    - Service
8. Is the malware has privilege escalation ?
9. Public reseach
    - [APT's malware analysis](https://github.com/kbandla/APTnotes) 
10. Ask the communities

Some references that can may help us in analysis a malware.
1. [Anti techinques list](https://search.unprotect.it/map)
2. Important Windows Functions, Appendix A, page 453, Practical Malware Analysis book.
3. [Examples of commands used by Attackers](https://fareedfauzi.github.io/notes/Commands-Used-Attackers/#)
4. [Common Windows API in Analyzing and Reversing Windows Malware](https://fareedfauzi.github.io/notes/windows_api_in_reversing_malware/#)

My malware analysis phases flow:

![Flow](https://raw.githubusercontent.com/fareedfauzi/fareedfauzi.github.io/master/assets/images/Malware-Analysis.jpg)

# References
1. Guys from Malware Research Telegram Group
